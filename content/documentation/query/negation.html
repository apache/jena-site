<!DOCTYPE html>
<html lang="en">
<head>
    

    <title>Apache Jena - ARQ - Negation</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="/css/bootstrap-extension.css" rel="stylesheet" type="text/css">
    <link href="/css/jena.css" rel="stylesheet" type="text/css">
    <link rel="shortcut icon" href="/images/favicon.ico" />

    <script src="https://code.jquery.com/jquery-2.2.4.min.js"
            integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
            crossorigin="anonymous"></script>
    <script src="/js/jena-navigation.js" type="text/javascript"></script>
    <script src="/js/bootstrap.min.js" type="text/javascript"></script>

    <script src="/js/improve.js" type="text/javascript"></script>

    
</head>

<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/index.html">
                <img class="logo-menu" src="/images/jena-logo/jena-logo-notext-small.png" alt="jena logo">Apache Jena</a>
        </div>

        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                <li id="homepage"><a href="/index.html"><span class="glyphicon glyphicon-home"></span> Home</a></li>
                <li id="download"><a href="/download/index.cgi"><span class="glyphicon glyphicon-download-alt"></span> Download</a></li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-book"></span> Learn <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-header">Tutorials</li>
                        <li><a href="/tutorials/index.html">Overview</a></li>
                        <li><a href="/documentation/fuseki2/index.html">Fuseki Triplestore</a></li>
                        <li><a href="/documentation/notes/index.html">How-To's</a></li>
                        <li><a href="/documentation/query/manipulating_sparql_using_arq.html">Manipulating SPARQL using ARQ</a></li>
                        <li><a href="/tutorials/rdf_api.html">RDF core API tutorial</a></li>
                        <li><a href="/tutorials/sparql.html">SPARQL tutorial</a></li>
                        <li><a href="/tutorials/using_jena_with_eclipse.html">Using Jena with Eclipse</a></li>
                        <li class="divider"></li>
                        <li class="dropdown-header">References</li>
                        <li><a href="/documentation/index.html">Overview</a></li>
                        <li><a href="/documentation/query/index.html">ARQ (SPARQL)</a></li>
                        <li><a href="/documentation/assembler/index.html">Assembler</a></li>
                        <li><a href="/documentation/tools/index.html">Command-line tools</a></li>
                        <li><a href="/documentation/rdfs/">Data with RDFS Inferencing</a></li>
                        <li><a href="/documentation/geosparql/index.html">GeoSPARQL</a></li>
                        <li><a href="/documentation/inference/index.html">Inference API</a></li>
                        <li><a href="/documentation/javadoc.html">Javadoc</a></li>
                        <li><a href="/documentation/ontology/">Ontology API</a></li>
                        <li><a href="/documentation/permissions/index.html">Permissions</a></li>
                        <li><a href="/documentation/extras/querybuilder/index.html">Query Builder</a></li>
                        <li><a href="/documentation/rdf/index.html">RDF API</a></li>
                        <li><a href="/documentation/rdfconnection/">RDF Connection - SPARQL API</a></li>
                        <li><a href="/documentation/io/">RDF I/O</a></li>
                        <li><a href="/documentation/rdfstar/index.html">RDF-star</a></li>
                        <li><a href="/documentation/shacl/index.html">SHACL</a></li>
                        <li><a href="/documentation/shex/index.html">ShEx</a></li>
                        <li><a href="/documentation/jdbc/index.html">SPARQL over JDBC</a></li>
                        <li><a href="/documentation/tdb/index.html">TDB</a></li>
                        <li><a href="/documentation/tdb2/index.html">TDB2</a></li>
                        <li><a href="/documentation/query/text-query.html">Text Search</a></li>
                    </ul>
                </li>

                <li class="drop down">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-book"></span> Javadoc <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="/documentation/javadoc.html">All Javadoc</a></li>
                        <li><a href="/documentation/javadoc/arq/">ARQ</a></li>
                        <li><a href="/documentation/javadoc_elephas.html">Elephas</a></li>
                        <li><a href="/documentation/javadoc/fuseki2/">Fuseki</a></li>
                        <li><a href="/documentation/javadoc/geosparql/">GeoSPARQL</a></li>
                        <li><a href="/documentation/javadoc/jdbc/">JDBC</a></li>
                        <li><a href="/documentation/javadoc/jena/">Jena Core</a></li>
                        <li><a href="/documentation/javadoc/permissions/">Permissions</a></li>
                        <li><a href="/documentation/javadoc/extras/querybuilder/">Query Builder</a></li>
                        <li><a href="/documentation/javadoc/shacl/">SHACL</a></li>
                        <li><a href="/documentation/javadoc/tdb/">TDB</a></li>
                        <li><a href="/documentation/javadoc/text/">Text Search</a></li>
                    </ul>
                </li>

                <li id="ask"><a href="/help_and_support/index.html"><span class="glyphicon glyphicon-question-sign"></span> Ask</a></li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-bullhorn"></span> Get involved <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="/getting_involved/index.html">Contribute</a></li>
                        <li><a href="/help_and_support/bugs_and_suggestions.html">Report a bug</a></li>
                        <li class="divider"></li>
                        <li class="dropdown-header">Project</li>
                        <li><a href="/about_jena/about.html">About Jena</a></li>
                        <li><a href="/about_jena/architecture.html">Architecture</a></li>
                        <li><a href="/about_jena/citing.html">Citing</a></li>
                        <li><a href="/about_jena/team.html">Project team</a></li>
                        <li><a href="/about_jena/contributions.html">Related projects</a></li>
                        <li><a href="/about_jena/roadmap.html">Roadmap</a></li>
                        <li class="divider"></li>
                        <li class="dropdown-header">ASF</li>
                        <li><a href="http://www.apache.org/">Apache Software Foundation</a></li>
                        <li><a href="http://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a></li>
                        <li><a href="http://www.apache.org/licenses/LICENSE-2.0">License</a></li>
                        <li><a href="http://www.apache.org/security/">Security</a></li>
                        <li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
                    </ul>
                </li>


    

                <li id="edit"><a href="https://github.com/apache/jena-site/edit/main/source/documentation/query/negation.md" title="Edit this page on GitHub"><span class="glyphicon glyphicon-pencil"></span> Edit this page</a></li>
            </ul>
        </div>
    </div>
</nav>


<div class="container">
    <div class="row">
        <div class="col-md-12">
            <div id="breadcrumbs">
                
                    





<ol class="breadcrumb">
    
    
        
        
    
        
        
            
                <li><a href='/documentation'>DOCUMENTATION</a></li>
            
            
        
    
        
        
            
                <li><a href='/documentation/query'>QUERY</a></li>
            
            
        
    
        
        
            
                <li class="active">NEGATION</li>
            
            
        
    
</ol>




                
            </div>
            <h1 class="title">ARQ - Negation</h1>
            
	<h3 id="negation-by-failure-optional--bound">Negation by Failure (OPTIONAL + !BOUND)</h3>
<p>Standard SPARQL 1.0 can perform negation using the idiom of
<code>OPTIONAL</code>/<code>!BOUND</code>. It is inconvenient and can be hard to use as
complexity increases. SPARQL 1.1 supports additional operators for
negation.</p>
<pre><code># Names of people who have not stated that they know anyone
PREFIX foaf: &lt;http://xmlns.com/foaf/0.1/&gt;
SELECT ?name
WHERE
{ 
  ?x foaf:givenName  ?name .
  OPTIONAL { ?x foaf:knows ?who } .
  FILTER (!BOUND(?who))
}
</code></pre>
<h3 id="exists-and-not-exists">EXISTS and NOT EXISTS</h3>
<p>The <code>EXISTS</code> and <code>NOT EXISTS</code> are now legal SPARQL 1.1 when used inside a <code>FILTER</code>,
they may be used as bare graph patterns only when <code>Syntax.syntaxARQ</code> is used</p>
<p>There is the <code>NOT EXISTS</code> operator which acts at the point in the query where it is
written. It does not bind any variables but variables already bound
in the query will have their bound value.</p>
<pre><code># Names of people who have not stated that they know anyone
PREFIX foaf: &lt;http://xmlns.com/foaf/0.1/&gt;
SELECT ?name
WHERE 
{
  ?x foaf:givenName ?name .
  FILTER NOT EXISTS { ?x foaf:knows ?who }
}
</code></pre>
<p>There is also an <code>EXISTS</code> operator.</p>
<pre><code># Names of people where it is stated that they know at least one other person.
PREFIX foaf: &lt;http://xmlns.com/foaf/0.1/&gt;
SELECT ?name
WHERE 
{
  ?x foaf:givenName ?name .
  FILTER EXISTS { ?x foaf:knows ?who . FILTER(?who != ?x) }
}
</code></pre>
<p>In this example, the pattern is a little more complex. Any graph
pattern is allowed although use of <code>OPTIONAL</code> is pointless (which
will always match, possible with no additional results).</p>
<p><code>NOT EXISTS</code> and <code>EXISTS</code> can also be used in <code>FILTER</code> expressions.
In SPARQL, <code>FILTER</code> expressions act over the whole of the basic
graph pattern in which they occur.</p>
<pre><code># Names of people who have not stated that they know anyone
PREFIX foaf: &lt;http://xmlns.com/foaf/0.1/&gt;
SELECT ?name
WHERE 
{
  ?x foaf:givenName ?name .
  FILTER (NOT EXISTS { ?x foaf:knows ?who })
 }
</code></pre>
<p>A note of caution:</p>
<pre><code>PREFIX foaf: &lt;http://xmlns.com/foaf/0.1/&gt;
SELECT ?name
WHERE 
{
  ?x foaf:givenName ?name .
  FILTER (NOT EXISTS { ?x foaf:knows ?y })
  ?x foaf:knows ?who
}
</code></pre>
<p>is the same as (it&rsquo;s a single basic graph pattern - the filter does
not break it in two):</p>
<pre><code>PREFIX foaf: &lt;http://xmlns.com/foaf/0.1/&gt;
SELECT ?name
WHERE 
{
  ?x foaf:givenName ?name .
  ?x foaf:knows ?y .
  FILTER (NOT EXISTS { ?x foaf:knows ?who })
}
</code></pre>
<p>and the <code>FILTER</code> will always be false (<code>{ ?x foaf:knows ?y }</code> must
have matched to get to this point in the query and using <code>?who</code>
instead makes no difference).</p>
<h3 id="minus">MINUS</h3>
<p>SPARQL 1.1 also provides a <code>MINUS</code> keyword which is broadly similar to
<code>NOT EXISTS</code> though does have some key differences as explained in the <a href="http://www.w3.org/TR/sparql11-query/#neg-notexists-minus">specification</a>:</p>
<pre><code>PREFIX foaf: &lt;http://xmlns.com/foaf/0.1/&gt;
SELECT ?name
WHERE
{
  ?x foaf:givenName ?name .
  ?x foaf:knows ?y .
  MINUS { ?x foaf:knows &lt;http://example.org/A&gt; }
}
</code></pre>
<p>Here we subtract any solutions where <code>?x</code> also knows <code>http://example.org/A</code></p>
<p>One of the key differences between <code>MINUS</code> and <code>NOT EXISTS</code> is that it is a child graph pattern and so breaks
the graph pattern and so the result of the query can change depending where the <code>MINUS</code> is placed.  This is
unlike the earlier <code>NOT EXISTS</code> examples where moving the position of the <code>FILTER</code> resulted
in equivalent queries.</p>
<h3 id="not-in">NOT IN</h3>
<p>SPARQL 1.1 also has a simpler form of negation for when you simply
need to restrict a variable to not being in a given set of values, this is the
<code>NOT IN</code> function:</p>
<pre><code>PREFIX foaf: &lt;http://xmlns.com/foaf/0.1/&gt;
SELECT ?name
WHERE
{
  ?x foaf:givenName ?name .
  ?x foaf:knows ?y .
  FILTER(?y NOT IN (&lt;http://example.org/A&gt;, &lt;http://example.org/B&gt;))
}
</code></pre>
<p>This would filter out matches where the value of <code>?y</code> is either <code>http://example.org/A</code> or <code>http://example.org/B</code></p>
<p><a href="index.html">ARQ documentation index</a></p>


        </div>
    </div>

</div>

<footer class="footer">
    <div class="container" style="font-size:80%" >
        <p>
            Copyright &copy; 2011&ndash;2022 The Apache Software Foundation, Licensed under the
            <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
        </p>
        <p>
            Apache Jena, Jena, the Apache Jena project logo, Apache and the Apache feather logos are trademarks of
            The Apache Software Foundation.
            <br/>
          <a href="https://privacy.apache.org/policies/privacy-policy-public.html"
             >Apache Software Foundation Privacy Policy</a>.
        </p>
    </div>
</footer>


<script type="text/javascript">
    var link = $('a[href="' + this.location.pathname + '"]');
    if (link != undefined)
        link.parents('li,ul').addClass('active');
</script>

</body>
</html>
