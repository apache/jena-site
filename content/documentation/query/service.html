<!DOCTYPE html>
<html lang="en">
<head>
    

    <title>Apache Jena - ARQ - Basic Federated SPARQL Query</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="/css/bootstrap-extension.css" rel="stylesheet" type="text/css">
    <link href="/css/jena.css" rel="stylesheet" type="text/css">
    <link rel="shortcut icon" href="/images/favicon.ico" />

    <script src="https://code.jquery.com/jquery-2.2.4.min.js"
            integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
            crossorigin="anonymous"></script>
    <script src="/js/jena-navigation.js" type="text/javascript"></script>
    <script src="/js/bootstrap.min.js" type="text/javascript"></script>

    <script src="/js/improve.js" type="text/javascript"></script>

    
</head>

<body>

<nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/index.html">
                <img class="logo-menu" src="/images/jena-logo/jena-logo-notext-small.png" alt="jena logo">Apache Jena</a>
        </div>

        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                <li id="homepage"><a href="/index.html"><span class="glyphicon glyphicon-home"></span> Home</a></li>
                <li id="download"><a href="/download/index.cgi"><span class="glyphicon glyphicon-download-alt"></span> Download</a></li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-book"></span> Learn <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-header">Tutorials</li>
                        <li><a href="/tutorials/index.html">Overview</a></li>
                        <li><a href="/documentation/fuseki2/index.html">Fuseki Triplestore</a></li>
                        <li><a href="/documentation/notes/index.html">How-To's</a></li>
                        <li><a href="/documentation/query/manipulating_sparql_using_arq.html">Manipulating SPARQL using ARQ</a></li>
                        <li><a href="/tutorials/rdf_api.html">RDF core API tutorial</a></li>
                        <li><a href="/tutorials/sparql.html">SPARQL tutorial</a></li>
                        <li><a href="/tutorials/using_jena_with_eclipse.html">Using Jena with Eclipse</a></li>
                        <li class="divider"></li>
                        <li class="dropdown-header">References</li>
                        <li><a href="/documentation/index.html">Overview</a></li>
                        <li><a href="/documentation/query/index.html">ARQ (SPARQL)</a></li>
                        <li><a href="/documentation/assembler/index.html">Assembler</a></li>
                        <li><a href="/documentation/tools/index.html">Command-line tools</a></li>
                        <li><a href="/documentation/rdfs/">Data with RDFS Inferencing</a></li>
                        <li><a href="/documentation/geosparql/index.html">GeoSPARQL</a></li>
                        <li><a href="/documentation/inference/index.html">Inference API</a></li>
                        <li><a href="/documentation/javadoc.html">Javadoc</a></li>
                        <li><a href="/documentation/ontology/">Ontology API</a></li>
                        <li><a href="/documentation/permissions/index.html">Permissions</a></li>
                        <li><a href="/documentation/extras/querybuilder/index.html">Query Builder</a></li>
                        <li><a href="/documentation/rdf/index.html">RDF API</a></li>
                        <li><a href="/documentation/rdfconnection/">RDF Connection - SPARQL API</a></li>
                        <li><a href="/documentation/io/">RDF I/O</a></li>
                        <li><a href="/documentation/rdfstar/index.html">RDF-star</a></li>
                        <li><a href="/documentation/shacl/index.html">SHACL</a></li>
                        <li><a href="/documentation/shex/index.html">ShEx</a></li>
                        <li><a href="/documentation/jdbc/index.html">SPARQL over JDBC</a></li>
                        <li><a href="/documentation/tdb/index.html">TDB</a></li>
                        <li><a href="/documentation/tdb2/index.html">TDB2</a></li>
                        <li><a href="/documentation/query/text-query.html">Text Search</a></li>
                    </ul>
                </li>

                <li class="drop down">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-book"></span> Javadoc <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="/documentation/javadoc.html">All Javadoc</a></li>
                        <li><a href="/documentation/javadoc/arq/">ARQ</a></li>
                        <li><a href="/documentation/javadoc_elephas.html">Elephas</a></li>
                        <li><a href="/documentation/javadoc/fuseki2/">Fuseki</a></li>
                        <li><a href="/documentation/javadoc/geosparql/">GeoSPARQL</a></li>
                        <li><a href="/documentation/javadoc/jdbc/">JDBC</a></li>
                        <li><a href="/documentation/javadoc/jena/">Jena Core</a></li>
                        <li><a href="/documentation/javadoc/permissions/">Permissions</a></li>
                        <li><a href="/documentation/javadoc/extras/querybuilder/">Query Builder</a></li>
                        <li><a href="/documentation/javadoc/shacl/">SHACL</a></li>
                        <li><a href="/documentation/javadoc/tdb/">TDB</a></li>
                        <li><a href="/documentation/javadoc/text/">Text Search</a></li>
                    </ul>
                </li>

                <li id="ask"><a href="/help_and_support/index.html"><span class="glyphicon glyphicon-question-sign"></span> Ask</a></li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-bullhorn"></span> Get involved <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="/getting_involved/index.html">Contribute</a></li>
                        <li><a href="/help_and_support/bugs_and_suggestions.html">Report a bug</a></li>
                        <li class="divider"></li>
                        <li class="dropdown-header">Project</li>
                        <li><a href="/about_jena/about.html">About Jena</a></li>
                        <li><a href="/about_jena/architecture.html">Architecture</a></li>
                        <li><a href="/about_jena/citing.html">Citing</a></li>
                        <li><a href="/about_jena/team.html">Project team</a></li>
                        <li><a href="/about_jena/contributions.html">Related projects</a></li>
                        <li><a href="/about_jena/roadmap.html">Roadmap</a></li>
                        <li class="divider"></li>
                        <li class="dropdown-header">ASF</li>
                        <li><a href="http://www.apache.org/">Apache Software Foundation</a></li>
                        <li><a href="http://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a></li>
                        <li><a href="http://www.apache.org/licenses/LICENSE-2.0">License</a></li>
                        <li><a href="http://www.apache.org/security/">Security</a></li>
                        <li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
                    </ul>
                </li>


    

                <li id="edit"><a href="https://github.com/apache/jena-site/edit/main/source/documentation/query/service.md" title="Edit this page on GitHub"><span class="glyphicon glyphicon-pencil"></span> Edit this page</a></li>
            </ul>
        </div>
    </div>
</nav>


<div class="container">
    <div class="row">
        <div class="col-md-12">
            <div id="breadcrumbs">
                
                    





<ol class="breadcrumb">
    
    
        
        
    
        
        
            
                <li><a href='/documentation'>DOCUMENTATION</a></li>
            
            
        
    
        
        
            
                <li><a href='/documentation/query'>QUERY</a></li>
            
            
        
    
        
        
            
                <li class="active">SERVICE</li>
            
            
        
    
</ol>




                
            </div>
            <h1 class="title">ARQ - Basic Federated SPARQL Query</h1>
            
	<p>There are already ways to access remote RDF data. The simplest is
to read a document which is an RDF graph and query it. Another way
is with the
<a href="http://www.w3.org/TR/rdf-sparql-protocol/">SPARQL protocol</a> which
allows a query to be sent to a remote service endpoint and the
results sent back (in RDF, or an
<a href="http://www.w3.org/TR/rdf-sparql-XMLres/">XML-based results format</a>
or even a <a href="http://www.w3.org/TR/rdf-sparql-json-res/">JSON one</a>).</p>
<p><code>SERVICE</code> is a feature of SPARQL 1.1 that allows an executing query
to make a SPARQL protocol to another SPARQL endpoint.</p>
<h2 id="syntax">Syntax</h2>
<pre><code>PREFIX : &lt;http://example/&gt;
PREFIX  dc:     &lt;http://purl.org/dc/elements/1.1/&gt;

SELECT ?a
FROM &lt;mybooks.rdf&gt;
{
  ?b dc:title ?title .
  SERVICE &lt;http://sparql.org/books&gt;
     { ?s dc:title ?title . ?s dc:creator ?a }
}
</code></pre>
<h2 id="algebra">Algebra</h2>
<p>There is an operator in the algebra.</p>
<pre><code>(prefix ((dc: &lt;http://purl.org/dc/elements/1.1/&gt;))
  (project (?a)
    (join
      (BGP [triple ?b dc:title ?title])
      (service &lt;http://sparql.org/books&gt;
          (BGP
            [triple ?s dc:title ?title]
            [triple ?s dc:creator ?a]
          ))
      )))
</code></pre>
<h2 id="performance-considerations">Performance Considerations</h2>
<p>This feature is a basic building block to allow remote access in
the middle of a query, not a general solution to the issues in
distributed query evaluation. The algebra operation is executed
without regard to how selective the pattern is. So the order of the
query will affect the speed of execution. Because it involves HTTP
operations, asking the query in the right order matters a lot.
Don&rsquo;t ask for the whole of a bookstore just to find a book whose
title comes from a local RDF file - ask the bookshop a query with
the title already bound from earlier in the query.</p>
<h2 id="controlling-service-requests">Controlling <code>SERVICE</code> requests.</h2>
<p>The <code>SERVICE</code> operation in a SPARQL query may be configured via the Context.
The values for configuration can be set in the global context (accessed via
<code>ARQ.getContext()</code>) or in the per-query execution context.</p>
<p>The prefix <code>arq:</code> is <code>&lt;http://jena.apache.org/ARQ#&gt;</code>.</p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Java Constant</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>arq:httpServiceAllowed</code></td>
<td><code>ARQ.httpServiceAllowed</code></td>
<td>true</td>
</tr>
<tr>
<td><code>arq:httpQueryClient</code></td>
<td><code>ARQ.httpQueryClient</code></td>
<td>System default.</td>
</tr>
<tr>
<td><code>arq:httpServiceSendMode</code></td>
<td>`ARQ.httpServiceSendMode | unset</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="arqhttpserviceallowed"><code>arq:httpServiceAllowed</code></h4>
<p>This setting can be used to disable execution of any SERVICE request in query.
Set to &ldquo;false&rdquo; to prohibit SERVICE requests.</p>
<h4 id="arqhttpqueryclient"><code>arq:httpQueryClient</code></h4>
<p>The java.net.http HttpClient object to use for SERVICE execution.</p>
<h4 id="arqhttpservicesendmode"><code>arq:httpServiceSendMode</code></h4>
<p>The HTTP operation to use. The value is a string or a <code>QuerySendMode</code> object.</p>
<p>String settings are:</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td>&ldquo;POST&rdquo;</td>
<td>Use HTTP POST. Same as &ldquo;asPost&rdquo;.</td>
</tr>
<tr>
<td>&ldquo;GET&rdquo;</td>
<td>Use HTTP GET unconditionally. Same as &ldquo;asGetAlways&rdquo;.</td>
</tr>
<tr>
<td>&ldquo;asGetAlways&rdquo;</td>
<td>Use HTTP GET.</td>
</tr>
<tr>
<td>&ldquo;asGetWithLimitBody&rdquo;</td>
<td>Use HTTP GET upto a size limit (usually 2kbytes).</td>
</tr>
<tr>
<td>&ldquo;asGetWithLimitForm&rdquo;</td>
<td>Use HTTP GET upto a size limit (usually 2kbytes), and use a HTML form for the query.</td>
</tr>
<tr>
<td>&ldquo;asPostForm&rdquo;</td>
<td>Use HTTP POST and use an HTML form for the query.</td>
</tr>
<tr>
<td>&ldquo;asPost&rdquo;</td>
<td>Use HTTP POST.</td>
</tr>
</tbody>
</table>
<h2 id="old-context-setting">Old Context setting</h2>
<p>Old settings are honored where possible but should not be used:</p>
<p>The prefix  <code>srv:</code> is the IRI <code>&lt;http://jena.hpl.hp.com/Service#&gt;</code>.</p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Usage</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>srv:queryTimeout</code></td>
<td>Set timeouts</td>
<td>none</td>
</tr>
<tr>
<td><code>srv:queryCompression</code></td>
<td>Enable use of deflation and GZip</td>
<td>true</td>
</tr>
<tr>
<td><code>srv:queryClient</code></td>
<td>Enable use of a specific client</td>
<td>none</td>
</tr>
<tr>
<td><code>srv:serviceContext</code></td>
<td>Per-endpoint configuration</td>
<td>none</td>
</tr>
</tbody>
</table>
<h4 id="srvquerytimeout"><code>srv:queryTimeout</code></h4>
<p>As documented above.</p>
<h4 id="srvquerycompression"><code>srv:queryCompression</code></h4>
<p>Sets the flag for use of deflation and GZip.</p>
<p>Boolean: True indicates that gzip compressed data is acceptable.</p>
<h4 id="srvqueryclient"><code>srv:queryClient</code></h4>
<p>Enable use of a specific client</p>
<p>Provides a slot for a specific <a href="https://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/client/HttpClient.html">HttpClient</a> for use with a specific <code>SERVICE</code></p>
<h4 id="srvservicecontext"><code>srv:serviceContext</code></h4>
<p>Provides a mechanism to override system context settings on a per URI basis.</p>
<p>The value is a <code>Map&lt;String,Context&gt;</code> where the map key is the URI of the service endpoint, and the <code>Context</code> is a set of values to override the default values.</p>
<p>If a context is provided for the URI, the system context is copied and the
context for the URI is used to set specific values.  This ensures that any URI
specific settings will be used.</p>


        </div>
    </div>

</div>

<footer class="footer">
    <div class="container" style="font-size:80%" >
        <p>
            Copyright &copy; 2011&ndash;2023 The Apache Software Foundation, Licensed under the
            <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
        </p>
        <p>
            Apache Jena, Jena, the Apache Jena project logo, Apache and the Apache feather logos are trademarks of
            The Apache Software Foundation.
            <br/>
          <a href="https://privacy.apache.org/policies/privacy-policy-public.html"
             >Apache Software Foundation Privacy Policy</a>.
        </p>
    </div>
</footer>


<script type="text/javascript">
    var link = $('a[href="' + this.location.pathname + '"]');
    if (link != undefined)
        link.parents('li,ul').addClass('active');
</script>

</body>
</html>
