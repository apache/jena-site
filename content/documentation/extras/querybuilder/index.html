<!DOCTYPE html>
<html lang="en">
<head>
    

    <title>Apache Jena - Jena Query Builder - A query builder for Jena.</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="/css/bootstrap-icons.css" rel="stylesheet" media="screen"><link rel="stylesheet" type="text/css" href="https://jena.apache.org/sass/jena.1b17c39a117e22b46db4c66f6395dc27c134a60377d87d2d5745b8600eb69722.css" integrity="sha256-GxfDmhF&#43;IrRttMZvY5XcJ8E0pgN32H0tV0W4YA62lyI=">
    <link rel="shortcut icon" href="/images/favicon.ico" />
    
</head>

<body>

<nav class="navbar navbar-expand-lg bg-body-tertiary" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <a class="navbar-brand" href="/index.html">
                <img class="logo-menu" src="/images/jena-logo/jena-logo-notext-small.png" alt="jena logo">Apache Jena</a>
        </div>

        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li id="homepage" class="nav-item"><a class="nav-link" href="/index.html"><span class="bi-house"></span> Home</a></li>
                <li id="download" class="nav-item"><a class="nav-link" href="/download/index.cgi"><span class="bi-download"></span> Download</a></li>
                <li class="nav-item dropdown">
                    <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false"><span class="bi-journal"></span> Learn <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-header">Tutorials</li>
                        <li><a class="dropdown-item" href="/tutorials/index.html">Overview</a></li>
                        <li><a class="dropdown-item"  href="/documentation/fuseki2/index.html">Fuseki Triplestore</a></li>
                        <li><a class="dropdown-item"  href="/documentation/notes/index.html">How-To's</a></li>
                        <li><a class="dropdown-item"  href="/documentation/query/manipulating_sparql_using_arq.html">Manipulating SPARQL using ARQ</a></li>
                        <li><a class="dropdown-item"  href="/tutorials/rdf_api.html">RDF core API tutorial</a></li>
                        <li><a class="dropdown-item"  href="/tutorials/sparql.html">SPARQL tutorial</a></li>
                        <li><a class="dropdown-item"  href="/tutorials/using_jena_with_eclipse.html">Using Jena with Eclipse</a></li>
                        <li class="dropdown-divider"></li>
                        <li class="dropdown-header">References</li>
                        <li><a class="dropdown-item"  href="/documentation/index.html">Overview</a></li>
                        <li><a class="dropdown-item"  href="/documentation/query/index.html">ARQ (SPARQL)</a></li>
                        <li><a class="dropdown-item"  href="/documentation/io/">RDF I/O</a></li>
                        <li><a class="dropdown-item"  href="/documentation/assembler/index.html">Assembler</a></li>
                        <li><a class="dropdown-item"  href="/documentation/tools/index.html">Command-line tools</a></li>
                        <li><a class="dropdown-item"  href="/documentation/rdfs/">Data with RDFS Inferencing</a></li>
                        <li><a class="dropdown-item"  href="/documentation/geosparql/index.html">GeoSPARQL</a></li>
                        <li><a class="dropdown-item"  href="/documentation/inference/index.html">Inference API</a></li>
                        <li><a class="dropdown-item"  href="/documentation/ontology/">Ontology API</a></li>
                        <li><a class="dropdown-item"  href="/documentation/permissions/index.html">Permissions</a></li>
                        <li><a class="dropdown-item"  href="/documentation/extras/querybuilder/index.html">Query Builder</a></li>
                        <li><a class="dropdown-item"  href="/documentation/rdf/index.html">RDF API</a></li>
                        <li><a class="dropdown-item"  href="/documentation/rdfconnection/">RDF Connection - SPARQL API</a></li>
                        <li><a class="dropdown-item"  href="/documentation/rdfstar/index.html">RDF-star</a></li>
                        <li><a class="dropdown-item"  href="/documentation/shacl/index.html">SHACL</a></li>
                        <li><a class="dropdown-item"  href="/documentation/shex/index.html">ShEx</a></li>
                        <li><a class="dropdown-item"  href="/documentation/tdb/index.html">TDB</a></li>
                        <li><a class="dropdown-item"  href="/documentation/tdb2/index.html">TDB2</a></li>
                        <li><a class="dropdown-item"  href="/documentation/query/text-query.html">Text Search</a></li>
                    </ul>
                </li>

                <li class="nav-item dropdown">
                    <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false"><span class="bi-journal-code"></span> Javadoc <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="/documentation/javadoc.html">All Javadoc</a></li>
                        <li><a class="dropdown-item" href="/documentation/javadoc/arq/">ARQ</a></li>
                        <li><a class="dropdown-item" href="/documentation/javadoc/fuseki2/">Fuseki</a></li>
                        <li><a class="dropdown-item" href="/documentation/javadoc/geosparql/">GeoSPARQL</a></li>
                        <li><a class="dropdown-item" href="/documentation/javadoc/jena/">Jena Core</a></li>
                        <li><a class="dropdown-item" href="/documentation/javadoc/permissions/">Permissions</a></li>
                        <li><a class="dropdown-item" href="/documentation/javadoc/extras/querybuilder/">Query Builder</a></li>
                        <li><a class="dropdown-item" href="/documentation/javadoc/shacl/">SHACL</a></li>
                        <li><a class="dropdown-item" href="/documentation/javadoc/tdb/">TDB</a></li>
                        <li><a class="dropdown-item" href="/documentation/javadoc/text/">Text Search</a></li>
                    </ul>
                </li>
            </ul>
            <form class="d-flex" role="search" action="/search" method="GET">
                <div class="input-group">
                    <input class="form-control border-end-0 border m-0" type="search" name="q" id="search-query" placeholder="Search...." aria-label="Search" style="width: 10rem;">
                    <button class="btn btn-outline-secondary border-start-0 border" type="submit">
                        <i class="bi-search"></i>
                    </button>
                </div>
            </form>
            <ul class="navbar-nav">
                <li id="ask" class="nav-item"><a class="nav-link" href="/help_and_support/index.html" title="Ask"><span class="bi-patch-question"></span><span class="text-body d-none d-xxl-inline"> Ask</span></a></li>

                <li class="nav-item dropdown">
                    <a href="#" title="Get involved" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false"><span class="bi-megaphone"></span><span class="text-body d-none d-xxl-inline"> Get involved </span><b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="/getting_involved/index.html">Contribute</a></li>
                        <li><a class="dropdown-item" href="/help_and_support/bugs_and_suggestions.html">Report a bug</a></li>
                        <li class="dropdown-divider"></li>
                        <li class="dropdown-header">Project</li>
                        <li><a class="dropdown-item" href="/about_jena/about.html">About Jena</a></li>
                        <li><a class="dropdown-item" href="/about_jena/architecture.html">Architecture</a></li>
                        <li><a class="dropdown-item" href="/about_jena/citing.html">Citing</a></li>
                        <li><a class="dropdown-item" href="/about_jena/team.html">Project team</a></li>
                        <li><a class="dropdown-item" href="/about_jena/contributions.html">Related projects</a></li>
                        <li><a class="dropdown-item" href="/about_jena/roadmap.html">Roadmap</a></li>
                        <li><a class="dropdown-item" href="/about_jena/security-advisories.html">Security Advisories</a></li>
                        <li class="dropdown-divider"></li>
                        <li class="dropdown-header">ASF</li>
                        <li><a class="dropdown-item" href="https://www.apache.org/">Apache Software Foundation</a></li>
                        <li><a class="dropdown-item" href="https://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a></li>
                        <li><a class="dropdown-item" href="https://www.apache.org/licenses/LICENSE-2.0">License</a></li>
                        <li><a class="dropdown-item" href="https://www.apache.org/security/">Security</a></li>
                        <li><a class="dropdown-item" href="https://www.apache.org/foundation/thanks.html">Thanks</a></li>
                    </ul>
                </li>
                
                
                
                
                <li class="nav-item" id="edit"><a class="nav-link" href="https://github.com/apache/jena-site/edit/main/source/documentation/extras/querybuilder/__index.md" title="Edit this page on GitHub"><span class="bi-pencil-square"></span><span class="text-body d-none d-xxl-inline"> Edit this page</span></a></li>
            </ul>
        </div>
    </div>
</nav>

<div class="container">
    <div class="row">
        <div class="col-md-12">
            
            <div id="breadcrumbs">
                




    
    


<ol class="breadcrumb mt-4 p-2 bg-body-tertiary">
    
    
        
        
    
        
        
            
                <li class="breadcrumb-item"><a href='/documentation'>DOCUMENTATION</a></li>
            
            
        
    
        
        
            
                <li class="breadcrumb-item"><a href='/documentation/extras'>EXTRAS</a></li>
            
            
        
    
        
        
            
                <li class="breadcrumb-item active">QUERYBUILDER</li>
            
            
        
    
</ol>




            </div>
            <h1 class="title">Jena Query Builder - A query builder for Jena.</h1>
            
            
<main class="d-flex flex-xl-row flex-column">
  
  <aside class="text-muted align-self-start mb-3 p-0 d-xl-none d-block">
    <h2 class="h6 sticky-top m-0 p-2 bg-body-tertiary">On this page</h2>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#constructing-expressions">Constructing Expressions</a></li>
    <li><a href="#update-builder">Update Builder</a></li>
    <li><a href="#where-builder">Where Builder</a></li>
    <li><a href="#template-usage">Template Usage</a></li>
    <li><a href="#prepared-statement-usage">Prepared Statement Usage</a></li>
  </ul>
</nav>
  </aside>
  <article class="flex-column me-lg-4">
    <h2 id="overview">Overview</h2>
<p>Query Builder provides implementations of Ask, Construct, Select and Update builders that allow developers to create queries without resorting to StringBuilders or similar solutions.  The Query Builder module is an extra package and is found in the <code>jena-querybuilder</code> jar.</p>
<p>Each of the builders has a series of methods to define the query.  Each method returns the builder for easy chaining.  The  example:</p>
<pre><code>SelectBuilder sb = new SelectBuilder()
    .addVar( &quot;*&quot; )
    .addWhere( &quot;?s&quot;, &quot;?p&quot;, &quot;?o&quot; );

Query q = sb.build() ;
</code></pre>
<p>produces</p>
<pre><code>SELECT *
WHERE
  { ?s ?p ?o }
</code></pre>
<h2 id="constructing-expressions">Constructing Expressions</h2>
<p>Expressions are primarily used in <code>filter</code> and <code>bind</code> statements as well as in select clauses.  All the standard expressions are implemented in the <code>ExprFactory</code> class.  An <code>ExprFactory</code> can be retrieved from any Builder by calling the <code>getExprFactory()</code> method.  This will create a Factory that has the same prefix mappings and the query.  An alternative is to construct the <code>ExprFactory</code> directly, this factory will not have the prefixes defined in <code>PrefixMapping.Extended</code>.</p>
<pre><code>SelectBuilder builder = new SelectBuilder();
ExprFactory exprF = builder.getExprFactory()
    .addPrefix( &quot;cf&quot;,
        &quot;http://vocab.nerc.ac.uk/collection/P07/current/CFSN0023/&quot;)
builder.addVar( exprF.floor( ?v ), ?floor )

    .addWhere( ?s, &quot;cf:air_temperature&quot;, ?v )
</code></pre>
<h2 id="update-builder">Update Builder</h2>
<p>The <code>UpdateBuilder</code> is used to create <code>Update</code>, <code>UpdateDeleteWhere</code> or <code>UpdateRequest</code> objects.  When an <code>UpdateRequest</code> is built is contains a single <code>Update</code> object as defined by the <code>UpdateBuilder</code>.  <code>Update</code> objects can  be added to an UpdateRequest using the <code>appendTo()</code> method.</p>
<pre><code>Var subj = Var.alloc( &quot;s&quot; );
Var obj = Var.alloc( &quot;o&quot; );

UpdateBuilder builder = new UpdateBuilder( PrefixMapping.Standard)
    .addInsert( subj, &quot;rdfs:comment&quot;, obj )
    .addWhere( subj, &quot;dc:title&quot;, obj);

UpdateRequest req = builder.buildRequest();

UpdateBuilder builder2 = new UpdateBuilder()
    .addPrefix( &quot;dc&quot;, &quot;http://purl.org/dc/elements/1.1/&quot;)
    .addDelete( subj, &quot;?p&quot;, obj)
    .where( subj, dc:creator, &quot;me&quot;)
    .appendTo( req );
</code></pre>
<h2 id="where-builder">Where Builder</h2>
<p>In some use cases it is desirable to create a where clause without constructing an entire query.  The <code>WhereBuilder</code> is designed to fit this need.  For example to construct the query:</p>
<pre><code>PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;
PREFIX foaf: &lt;http://xmlns.com/foaf/0.1/&gt;

SELECT ?page ?type WHERE
{
    ?s foaf:page ?page .
    { ?s rdfs:label &quot;Microsoft&quot;@en . BIND (&quot;A&quot; as ?type) }
    UNION
    { ?s rdfs:label &quot;Apple&quot;@en . BIND (&quot;B&quot; as ?type) }
}
</code></pre>
<p>You could use a WhereBuilder to construct the union queries and add them to a Select or other query builder.</p>
<pre><code>WhereBuilder whereBuilder = new WhereBuilder()
    .addPrefix( &quot;rdfs&quot;,  &quot;http://www.w3.org/2000/01/rdf-schema#&quot; )
    addWhere( &quot;?s&quot;, &quot;rdfs:label&quot;, &quot;'Microsoft'@en&quot; )
    .addBind( &quot;'A'&quot;, &quot;?type&quot;)
    .addUnion( new WhereBuilder()
        .addPrefix( &quot;rdfs&quot;,  &quot;http://www.w3.org/2000/01/rdf-schema#&quot; )
        .addWhere( &quot;?s&quot;, &quot;rdfs:label&quot;, &quot;'Apple'@en&quot; )
        .addBind( &quot;'B'&quot;, &quot;?type&quot;)
    );

SelectBuilder builder = new SelectBuilder()
   .addPrefix( &quot;rdfs&quot;,  &quot;http://www.w3.org/2000/01/rdf-schema#&quot; )
   .addPrefix( &quot;foaf&quot;, &quot;http://xmlns.com/foaf/0.1/&quot; );
   .addVar( &quot;?page&quot;)
   .addVar( &quot;?type&quot; )
   .addWhere( &quot;?s&quot;, &quot;foaf:page&quot;,  &quot;?page&quot; )
   .addWhere( whereBuilder );
</code></pre>
<p>The where clauses could be built inline as:</p>
<pre><code>SelectBuilder builder = new SelectBuilder()
  .addPrefixs( PrefixMapping.Standard )
  .addPrefix( &quot;foaf&quot;, &quot;http://xmlns.com/foaf/0.1/&quot; );
  .addVar( &quot;?page&quot;)
  .addVar( &quot;?type&quot; )
  .addWhere( &quot;?s&quot;, &quot;foaf:page&quot;,  &quot;?page&quot; )
  .addWhere( new WhereBuilder()
      .addPrefix( &quot;rdfs&quot;,  &quot;http://www.w3.org/2000/01/rdf-schema#&quot; )
      .addWhere( &quot;?s&quot;, &quot;rdfs:label&quot;, &quot;'Microsoft'@en&quot; )
      .addBind( &quot;'A'&quot;, &quot;?type&quot;)
      .addUnion( new WhereBuilder()
          .addPrefix( &quot;rdfs&quot;,  &quot;http://www.w3.org/2000/01/rdf-schema#&quot; )
          .addWhere( &quot;?s&quot;, &quot;rdfs:label&quot;, &quot;'Apple'@en&quot; )
          .addBind( &quot;'B'&quot;, &quot;?type&quot;)
      )
  );
</code></pre>
<h2 id="template-usage">Template Usage</h2>
<p>In addition to making it easier to build valid queries the QueryBuilder has a clone method.
Using this a developer can create as &ldquo;Template&rdquo; query and add to it as necessary.</p>
<p>For example using the above query as the &ldquo;template&rdquo; with this code:</p>
<pre><code>SelectBuilder sb2 = sb.clone();
sb2.addPrefix( &quot;foaf&quot;, &quot;http://xmlns.com/foaf/0.1/&quot; )
   .addWhere( ?s, RDF.type, &quot;foaf:Person&quot;) ;
</code></pre>
<p>produces</p>
<pre><code>PREFIX foaf: &lt;http://xmlns.com/foaf/0.1/&gt;
SELECT *
WHERE
  { ?s ?p ?o .
    ?s &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; foaf:person .
  }
</code></pre>
<h2 id="prepared-statement-usage">Prepared Statement Usage</h2>
<p>The query builders have the ability to replace variables with other values.  This can be</p>
<pre><code>SelectBuilder sb = new SelectBuilder()
    .addVar( &quot;*&quot; )
    .addWhere( &quot;?s&quot;, &quot;?p&quot;, &quot;?o&quot; );

sb.setVar( Var.alloc( &quot;?o&quot; ), NodeFactory.createURI( &quot;http://xmlns.com/foaf/0.1/Person&quot; ) ) ;
Query q = sb.build();
</code></pre>
<p>produces</p>
<pre><code>SELECT *
WHERE
  { ?s ?p &lt;http://xmlns.com/foaf/0.1/Person&gt; }
</code></pre>

  </article>
  
  <aside class="text-muted align-self-start mb-3 mb-xl-5 p-0 d-none d-xl-flex flex-column sticky-top">
    <h2 class="h6 sticky-top m-0 p-2 bg-body-tertiary">On this page</h2>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#constructing-expressions">Constructing Expressions</a></li>
    <li><a href="#update-builder">Update Builder</a></li>
    <li><a href="#where-builder">Where Builder</a></li>
    <li><a href="#template-usage">Template Usage</a></li>
    <li><a href="#prepared-statement-usage">Prepared Statement Usage</a></li>
  </ul>
</nav>
  </aside>
</main>

        </div>
    </div>
</div>

<footer class="bd-footer py-4 py-md-5 mt-4 mt-lg-5 bg-body-tertiary">
    <div class="container" style="font-size:80%" >
        <p>
            Copyright &copy; 2011&ndash;2023 The Apache Software Foundation, Licensed under the
            <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
        </p>
        <p>
            Apache Jena, Jena, the Apache Jena project logo, Apache and the Apache feather logos are trademarks of
            The Apache Software Foundation.
            <br/>
          <a href="https://privacy.apache.org/policies/privacy-policy-public.html"
             >Apache Software Foundation Privacy Policy</a>.
        </p>
    </div>
</footer>

<script src="/js/popper.min.js.js" type="text/javascript"></script>
<script src="/js/bootstrap.min.js" type="text/javascript"></script>
<script src="/js/improve.js" type="text/javascript"></script>

<script type="text/javascript">
(function() {
    'use strict'
    
    

    const links = document.querySelectorAll(`a[href="${window.location.pathname}"]`)
    if (links !== undefined && links !== null) {
        for (const link of links) {
            
            link.classList.add('active')
            let parentElement = link.parentElement
            let count = 0
            const levelsLimit = 4
            
            
            
            
            
            while (['UL', 'LI'].includes(parentElement.tagName) && count <= levelsLimit) {
                if (parentElement.tagName === 'LI') {
                    
                    
                    
                    parentElement.querySelector('a:first-child').classList.add('active')
                }
                parentElement = parentElement.parentElement
                count++
            }
        }
    }
})()
</script>

</body>
</html>
